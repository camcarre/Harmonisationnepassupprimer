<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>Contoso Task Pane Add-in</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/><link href="450eec394a3c9f6892d5.css" rel="stylesheet"/><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body class="ms-font-m ms-welcome ms-Fabric"><div id="global-msg" style="display:none;max-width:900px;margin:18px auto 0 auto;padding:10px 18px;border-radius:7px;font-size:15px;background:#fffbe6;color:#b36b00;border:1px solid #ffe58f"></div><header class="ms-welcome__header ms-bgColor-neutralLighter"><h1 class="ms-font-su">Harmonisation Excel</h1></header><main id="app-body" class="ms-welcome__main" style="display:flex"><div class="welcome-panel active-section" style="background:#f4f8fb;border-radius:8px;padding:18px 24px;margin-bottom:18px;max-width:700px"><h2 style="margin-top:0">Bienvenue dans l'outil d'harmonisation intelligente</h2><p>Cette extension vous permet&nbsp;:</p><ul><li>Harmoniser rapidement une colonne de donn√©es brutes selon un r√©f√©rentiel personnalisable</li><li>B√©n√©ficier de suggestions automatiques (matching flou) et de la validation manuelle</li><li>Rechercher et filtrer les correspondances existantes</li><li>Annuler la derni√®re harmonisation (Undo)</li><li>Enrichir dynamiquement votre base de correspondances</li></ul><div class="quick-guide" style="margin-top:12px"><strong>Guide rapide&nbsp;:</strong><ol style="margin:8px 0 0 18px"><li>S√©lectionnez la colonne √† harmoniser dans Excel</li><li>Chargez ou cr√©ez votre BDD d'harmonisation</li><li>Choisissez le th√®me (feuille) adapt√©</li><li>Cliquez sur <b>Harmoniser</b> et validez les suggestions</li><li>T√©l√©chargez la BDD enrichie si besoin</li></ol></div></div><div class="harmonisation-container"><h2>Harmonisation de colonne</h2><div id="harmo-status" style="margin-bottom:10px;color:#217346;font-size:14px"></div><button id="select-column-btn">S√©lectionner la colonne √† harmoniser</button> <input type="file" id="bdd-file-input" accept=".xlsx,.xls" style="display:none"/> <button id="load-bdd-btn">Charger la BDD d'harmonisation</button> <span id="bdd-filename" style="display:none;margin-left:10px"></span><div id="theme-section" style="display:none"><label for="theme-select">Th√®me :</label> <select id="theme-select"></select></div><div id="harmo-dest-choice" style="margin:14px 0 18px 0"><label style="margin-right:18px"><input type="radio" name="harmo-dest" value="replace"> Remplacer la colonne s√©lectionn√©e</label> <label><input type="radio" name="harmo-dest" value="right" checked="checked"> Ins√©rer √† droite de la s√©lection</label></div><button id="harmonize-btn" style="display:none">Harmoniser</button><div id="report-section" style="display:none"><h3>Valeurs non trouv√©es :</h3><ul id="not-found-list"></ul></div><button id="download-bdd-btn" style="display:none;margin-left:10px">T√©l√©charger la BDD</button> <button id="save-bdd-btn" style="display:none;margin-left:10px">Sauvegarder la BDD</button><div id="search-section" style="display:none;margin-top:16px"><input id="search-mapping" placeholder="Rechercher dans la BDD..." style="width:60%;padding:4px"/><table id="mapping-table" style="width:100%;border-collapse:collapse;margin-top:8px"><thead><tr><th>Brut</th><th>Harmonis√©</th></tr></thead><tbody></tbody></table></div><button id="undo-harmonisation-btn" style="display:none;margin-top:10px">Annuler la derni√®re harmonisation</button></div></main><div id="modal-harmonisation" class="modal" style="display:none"><div class="modal-content" style="max-width:820px;padding:32px 36px 28px 36px;border-radius:18px;box-shadow:0 6px 32px #0002;background:#fff"><button id="close-modal" class="close-modal" aria-label="Fermer" style="position:absolute;top:18px;right:22px;font-size:2rem;background:0 0;border:none;color:#888;cursor:pointer">&times;</button><h2 style="text-align:center;font-size:2.1rem;margin-bottom:8px;letter-spacing:.5px">Harmonisation de colonne</h2><div id="harmonisation-table-container" style="margin-bottom:12px"><table id="harmonisation-table" style="width:100%;margin-bottom:8px;border-radius:10px;overflow:hidden;box-shadow:0 1px 8px #0001;background:#fafcff"><thead style="background:#f0f5ff"><tr style="font-size:1.08rem"><th style="padding:10px 0">Valeur brute</th><th style="padding:10px 0">Suggestions</th><th style="padding:10px 0">Saisie manuelle</th><th style="padding:10px 0">R√©sultat</th></tr></thead><tbody></tbody></table></div><div id="harmo-stats-bar" style="margin-bottom:18px;font-size:15px;background:#f7f7fa;border-radius:7px;padding:7px 0;text-align:center;color:#555;box-shadow:0 1px 4px #0001"></div><div class="modal-actions" style="display:flex;gap:24px;justify-content:center;margin-top:10px"><button id="apply-harmonisation-btn" style="font-size:17px;padding:10px 32px;border-radius:8px;background:#52c41a;color:#fff;font-weight:600;box-shadow:0 2px 8px #52c41a22">Tout valider</button> <button id="cancel-harmonisation-btn" style="font-size:17px;padding:10px 32px;border-radius:8px;background:#eee;color:#333;font-weight:600">Annuler</button> <button id="download-bdd-btn" style="font-size:17px;padding:10px 32px;border-radius:8px;background:#1890ff;color:#fff;font-weight:600;display:none">T√©l√©charger la BDD enrichie</button></div></div></div><div id="harmonisation-stats" style="display:none;max-width:900px;margin:18px auto 0 auto;padding:10px 18px 10px 18px;border-radius:7px;font-size:15px;background:#f7fbe6;color:#333;border:1px solid #e0e0e0;position:relative"><button id="close-stats" style="position:absolute;top:8px;right:12px;background:0 0;border:none;font-size:1.5rem;color:#888;cursor:pointer">&times;</button><div id="harmonisation-stats-content"></div></div><nav id="mini-nav" class="mini-nav"><button class="mini-nav-btn" id="nav-home" title="Accueil"><svg width="24" height="24" fill="none" stroke="#222" stroke-width="2" viewBox="0 0 24 24"><path d="M3 12L12 3l9 9"/><path d="M9 21V9h6v12"/></svg> <span>Accueil</span></button> <button class="mini-nav-btn" id="nav-harmo" title="Harmonisation"><svg width="24" height="24" fill="none" stroke="#222" stroke-width="2" viewBox="0 0 24 24"><rect x="3" y="7" width="18" height="13" rx="2"/><path d="M16 3v4M8 3v4"/></svg> <span>Harmoniser</span></button></nav><div id="help-modal" class="modal" style="display:none"><div class="modal-content" style="max-width:800px;padding:32px 36px 28px 36px;border-radius:18px;box-shadow:0 6px 32px #0002;background:#fff"><button id="close-help-modal" class="close-modal" aria-label="Fermer" style="position:absolute;top:18px;right:22px;font-size:2rem;background:0 0;border:none;color:#888;cursor:pointer">&times;</button><h2 style="text-align:center;font-size:2.1rem;margin-bottom:24px;letter-spacing:.5px">Guide d'utilisation</h2><div style="max-height:70vh;overflow-y:auto;padding-right:16px"><section style="margin-bottom:24px"><h3 style="color:#1890ff;margin-bottom:12px">üéØ Objectif de l'outil</h3><p>Cet outil vous aide √† harmoniser vos donn√©es Excel en standardisant les valeurs selon une base de donn√©es de r√©f√©rence.</p></section><section style="margin-bottom:24px"><h3 style="color:#1890ff;margin-bottom:12px">üìù Processus d'harmonisation</h3><ol style="padding-left:20px"><li style="margin-bottom:8px">S√©lectionnez la colonne √† harmoniser dans Excel</li><li style="margin-bottom:8px">Chargez votre BDD de r√©f√©rence (fichier Excel)</li><li style="margin-bottom:8px">Choisissez le th√®me correspondant √† votre colonne</li><li style="margin-bottom:8px">Lancez l'harmonisation</li></ol></section><section style="margin-bottom:24px"><h3 style="color:#1890ff;margin-bottom:12px">üîÑ Fen√™tre d'harmonisation</h3><ul style="padding-left:20px"><li style="margin-bottom:8px"><strong>Valeur brute :</strong> La valeur originale de votre colonne</li><li style="margin-bottom:8px"><strong>Suggestions :</strong> Les correspondances trouv√©es dans la BDD (avec score de similarit√©)</li><li style="margin-bottom:8px"><strong>Saisie manuelle :</strong> Pour entrer une valeur personnalis√©e ou choisir parmi les valeurs existantes</li></ul></section><section style="margin-bottom:24px"><h3 style="color:#1890ff;margin-bottom:12px">‚öôÔ∏è Param√®tres importants</h3><ul style="padding-left:20px"><li style="margin-bottom:12px"><strong>Seuil de similarit√© floue (40-100%) :</strong><br>- Contr√¥le la pr√©cision des suggestions<br>- Plus le seuil est √©lev√©, plus les suggestions seront pr√©cises<br>- Plus le seuil est bas, plus vous aurez de suggestions</li></ul></section><section style="margin-bottom:24px"><h3 style="color:#1890ff;margin-bottom:12px">üí° Astuces</h3><ul style="padding-left:20px"><li style="margin-bottom:8px">La saisie manuelle propose l'autocompl√©tion avec les valeurs existantes</li><li style="margin-bottom:8px">Les nouvelles harmonisations sont automatiquement ajout√©es √† la BDD</li><li style="margin-bottom:8px">Utilisez le bouton "Tout valider" pour appliquer les changements</li><li style="margin-bottom:8px">Pensez √† sauvegarder r√©guli√®rement votre BDD</li></ul></section><section><h3 style="color:#1890ff;margin-bottom:12px">üé® Code couleurs</h3><ul style="padding-left:20px"><li style="margin-bottom:8px;background:#f6ffed;padding:4px 8px">Vert clair : Correspondance exacte trouv√©e dans la BDD</li><li style="margin-bottom:8px;background:#e6fffb;padding:4px 8px">Bleu clair : Suggestion automatique</li><li style="margin-bottom:8px;background:#fff7e6;padding:4px 8px">Orange clair : Saisie manuelle</li><li style="margin-bottom:8px;background:#fff1f0;padding:4px 8px">Rouge clair : Non trouv√©/Non harmonis√©</li></ul></section></div></div></div><script src="https://cdn.sheetjs.com/xlsx-0.18.5/package/dist/xlsx.full.min.js"></script><script src="5e3a794d11d4358a42e6.js"></script></body></html>